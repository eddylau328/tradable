{% extends "chat/message.html" %}

{% block chatbox %}
<ul class="list-group m-0 p-0 " id='chatroom-items'>
{% for chatroom in object_list %}

<li class="d-flex list-group-item p-3 m-0 btn btn-secondary">
	<img src="https://www.law.berkeley.edu/wp-content/uploads/2015/04/Blank-profile.png" class="icon img-thumbnail rounded-circle ">
	{% if user != chatroom.first %}
	<a href="/../messages/{{ chatroom.first }}/">
	<div style="max-width:0em">
		<div class="font-weight-bold text-left pb-1" id="chatboxbarname">{{ chatroom }}</div>
		<div class="font-weight-light " id="chatboxbartext">{{ chatroom.first }}</div>
	</div>
	</a>
	{% else %}
	<a href="/../messages/{{ chatroom.second }}/">
	<div style="max-width:0em">
		<div class="font-weight-bold text-left pb-1" id="chatboxbarname">{{ chatroom }}</div>
		<div class="font-weight-light " id="chatboxbartext">{{ chatroom.second }}</div>
	</div>
	</a>
	{% endif %}
</li>
{% endfor %}
</href>

{% endblock %}

{% block script %}
<script>
// websocket scripts
//console.log(window.location)
var loc = window.location

var wsStart = 'ws://'
if (loc.protocol == 'https:'){
    wsStart = 'wss://'
}
var endpoint = wsStart + loc.host + loc.pathname
var socket = new WebSocket(endpoint)

socket.onmessage = function(e){
    console.log("message", e)
}
socket.onopen= function(e){
    console.log("open", e)
}
socket.onerror= function(e){
    console.log("error", e)
}
socket.onclose= function(e){
    console.log("close", e)
}

</script>
{% endblock %}
